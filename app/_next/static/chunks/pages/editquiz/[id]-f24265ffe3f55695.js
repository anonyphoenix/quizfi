(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{20251:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editquiz/[id]",function(){return n(30252)}])},30252:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return L}});var i=n(11527),o=n(66418),s=function(e){let{number:t,label:n,fontSize:s,bold:r,onChange:l,defaultValue:a}=e,u=e=>{let t=Number(e.target.value);l(t||a)};return(0,i.jsx)(o.Z,{value:t,label:n,type:"number",defaultValue:a,onChange:u,InputProps:{inputProps:{min:0,required:!0}},sx:{border:"none",borderRadius:0,fontSize:s,fontWeight:r?"bold":""}})},r=function(e){let{text:t,fontSize:n,defaultValue:s,bold:r,autoFocus:l=!1,onChange:a}=e,u=e=>{let t=e.target.value;a(t||"")};return(0,i.jsx)(o.Z,{value:t,onChange:u,autoFocus:l,defaultValue:s,fullWidth:!0,multiline:!0,variant:"standard",sx:{border:"none",borderRadius:0,"& .MuiOutlinedInput-root":{border:"none",borderRadius:0,"&:hover":{},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none",borderBottom:"2px #000 solid",padding:0}},"& .MuiInputBase-root":{fontSize:n,fontWeight:r?700:void 0,padding:0,"&:focus":{outline:"none"}},"& .MuiOutlinedInput-input":{padding:0}}})},l=n(98137),a=n(39345),u=n(9491),d=n(36178),c=n(81823),x=n(83570),p=n(442),m=n(42884),f=function(e){let{option:t,questionId:n}=e,o=(0,m.I0)(),s=e=>{o((0,a.Dx)({questionId:n,optionId:t.id,isAnswer:e.target.checked}))},f=(0,m.v9)(e=>{let t=e.quizform.quiz.questions.find(e=>e.id===n);return t?t.options:[]}),h=()=>{f.length>1?o((0,a.Jk)({questionId:n,optionId:t.id})):o((0,l.wN)({type:"error",message:"You need to set at least one option"}))};return(0,i.jsxs)(d.ZP,{container:!0,spacing:2,alignItems:"center",sx:{width:"100%",margin:0},children:[(0,i.jsx)(d.ZP,{item:!0,children:(0,i.jsx)(c.Z,{checked:t.isAnswer,onChange:s})}),(0,i.jsx)(d.ZP,{item:!0,sx:{flexGrow:1},children:(0,i.jsx)(r,{fontSize:"16px",text:t.title,defaultValue:"",onChange:e=>{o((0,a.SL)({questionId:n,optionId:t.id,title:e}))}},t.id)}),(0,i.jsx)(d.ZP,{item:!0,children:(0,i.jsx)(x.Z,{onClick:h,title:"Remove",children:(0,i.jsx)(p.Z,{children:(0,i.jsx)(u.Z,{})})})})]})},h=n(53003),j=n(99661),b=n(20057),g=n(252),Z=n(51029),y=n(9401),z=n(59496),q=n(50959),v=n(59739),C=function(e){var t;let{question:n,index:o,autofocus:u}=e,d=(0,m.I0)(),c=(0,q.useRef)(null),C=(0,m.v9)(e=>e.quizform.quiz.questions),I=()=>{C.length>1?d((0,a.dA)(n.id)):d((0,l.wN)({type:"error",message:"You need to have at least one question"}))};(0,q.useEffect)(()=>{u&&c.current&&c.current.scrollIntoView({behavior:"smooth"})},[u]);let w=()=>{let e={id:(0,v.Z)(),title:"",isAnswer:!1};d((0,a.Zm)({questionId:n.id,option:e}))};return(0,i.jsx)(b.Z,{ref:u?c:null,sx:{my:2,py:{xs:0,sm:1},px:{xs:0,sm:2}},children:(0,i.jsxs)(g.Z,{children:[(0,i.jsxs)(Z.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)(y.Z,{sx:{flexGrow:1,mr:1,fontSize:"16px"},component:"div",children:"".concat(o,".")}),(0,i.jsx)(r,{defaultValue:"",text:n.prompt,onChange:e=>d((0,a.ZR)({questionId:n.id,prompt:e})),fontSize:"16px",autoFocus:u})]}),null===(t=n.options)||void 0===t?void 0:t.map(e=>(0,i.jsx)(f,{option:e,questionId:n.id},e.id)),(0,i.jsxs)(Z.Z,{sx:{ml:2},children:[(0,i.jsx)(x.Z,{title:"Add option",onClick:w,sx:{my:0},children:(0,i.jsx)(p.Z,{children:(0,i.jsx)(j.Z,{color:"primary"})})}),(0,i.jsx)(z.Z,{orientation:"horizontal",flexItem:!0}),(0,i.jsxs)(Z.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[(0,i.jsx)(s,{onChange:e=>{d((0,a.mp)({questionId:n.id,points:e}))},defaultValue:1,number:n.points,fontSize:"24px",label:"Points"}),(0,i.jsx)(x.Z,{title:"Delete question",children:(0,i.jsx)(p.Z,{onClick:I,children:(0,i.jsx)(h.Z,{color:"error"})})})]})]})]})})},I=n(28822),w=n(47569),A=n(32443),S=n(9532),k=n(84449),P=n(21764),E=n(83216),_=n(56563),D=n(13436),N=n(56809),R=n(97886),V=n(7565),M=n(28026),O=n.n(M),W=n(61110),B=n(71806),F=n(88429),G=n(52147),L=function(){let e=(0,k.useRouter)(),t=(0,m.I0)(),n=(0,m.v9)(e=>e.quizform.quiz),[l,u]=(0,q.useState)(n.timelimit),[d,c]=(0,q.useState)(!1),[f,h]=(0,q.useState)(-1),z=(0,D.m)().address;z||(z="0x0");let{data:M,error:L,isPending:T,sendTransaction:Q}=(0,W.p)(),X=(0,A.Z)(),[U,Y]=(0,q.useState)(0);async function J(e){e.preventDefault();let t=new FormData(e.target),n=t.get("value");(0,F.f)(n)>0&&Q({to:"0xfa2358D363673784eB03c94BdFA2751089508a7f",value:(0,F.f)(n)})}let H=e=>{let t=Number(e.target.value);Y(t)},{isLoading:K,isSuccess:$}=(0,B.A)({hash:M});(0,q.useEffect)(()=>{async function e(){try{t((0,a.cv)(U));let e=await S.Z.get("/api/save-tx?quizId=".concat(n.id,"&amount=").concat(U,"&hash=").concat(M));e.data}catch(e){console.log("error in save tx")}console.log("tx processed")}U>0&&e()},[$]);let ee=()=>{let e={id:(0,v.Z)(),prompt:"",points:1,options:[{id:(0,v.Z)(),title:"",isAnswer:!1}]};h(n.questions.length),t((0,a.xL)(e))};return(0,q.useEffect)(()=>{t((0,a.bD)(l))},[l,t]),(0,q.useEffect)(()=>(t((0,I.Rx)("quiz_edit")),()=>{t((0,I.jC)())}),[t]),(0,q.useEffect)(()=>{let n=async()=>{try{let n=await S.Z.get("/api/get-quiz-by-id?id=".concat(e.query.id)),i=n.data;c("public"==i.status),z==i.owner||"0x0"==i.owner?t((0,a.XS)(i)):(console.log("403 forbidden"),t((0,a.GE)()))}catch(e){console.log(e)}};return e.query.id&&n(),()=>{t((0,a.GE)())}},[e.query.id,t]),(0,i.jsxs)(Z.Z,{sx:{maxWidth:"md",width:"100%",mt:4},children:[(0,i.jsx)(b.Z,{sx:{backgroundColor:"#fff",px:2,py:1,mt:1,mb:1},children:(0,i.jsxs)(g.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsx)(r,{text:n.title,onChange:e=>{t((0,a.Rk)(e))},defaultValue:n.title,fontSize:"32px",bold:!0}),(0,i.jsx)(r,{text:n.description,onChange:e=>{t((0,a.vZ)(e))},defaultValue:n.description,fontSize:"16px"}),(0,i.jsxs)(Z.Z,{sx:{mt:2},children:[(0,i.jsx)(V._,{dateAdapter:R.y,children:(0,i.jsx)(N.x,{label:"Start time",value:O()(n.startTime),onAccept:e=>{e&&t((0,a.Dt)(e))},onChange:e=>{e&&t((0,a.Dt)(e))}})}),"\xa0\xa0\xa0",(0,i.jsx)(s,{defaultValue:10,number:n.timelimit,onChange:e=>{t((0,a.bD)(e))},fontSize:"16px",label:"Time Limit (minutes)"})]}),(0,i.jsxs)(Z.Z,{sx:{mt:2},children:[n.prizeAmount&&n.prizeAmount>0?"Prize: ".concat(n.prizeAmount," EDU"):(0,i.jsxs)("form",{autoComplete:"off",onSubmit:J,children:[(0,i.jsx)(o.Z,{label:"Prize in EDU",required:!0,type:"number",onChange:H,defaultValue:0,disabled:T||K||$,sx:{border:"none",borderRadius:0,fontSize:16,fontWeight:"bold",maxWidth:"%60"},inputProps:{step:1e-4},name:"value"}),"\xa0\xa0\xa0",U>0&&(0,i.jsx)(w.Z,{variant:"contained",disabled:$,startIcon:(0,i.jsx)(G.Z,{style:{color:X.palette.secondary.main}}),style:{backgroundColor:X.palette.primary.main,color:X.palette.secondary.main,height:54},type:"submit",children:T||K?"Confirming...":$?"Paid":"Pay"})]}),(0,i.jsx)(E.Z,{sx:{mb:2},children:"0x0"!=z?(0,i.jsx)(_.Z,{control:(0,i.jsx)(P.Z,{checked:d,disabled:!$&&0==n.prizeAmount,onChange:()=>{($||n.prizeAmount&&n.prizeAmount>0)&&(t((0,a.g0)()),c(!d))}}),label:$||n.prizeAmount&&n.prizeAmount>0?"Public Quiz":"Public Quiz (requires payment)"}):(0,i.jsx)(_.Z,{disabled:!0,control:(0,i.jsx)(P.Z,{}),label:"Public Quiz (connect wallet first)"})})]}),(0,i.jsx)(y.Z,{variant:"body2",sx:{color:"#666",display:"flex",mt:2,alignItems:"center"},children:"Note:\xa0Mark the correct option for all questions\xa0"})]})}),n.questions&&n.questions.map((e,t)=>(0,i.jsx)(C,{index:t+1,question:e,autofocus:t==f},e.id)),(0,i.jsx)(x.Z,{title:"Add question",children:(0,i.jsx)(p.Z,{onClick:ee,sx:{backgroundColor:"primary"},children:(0,i.jsx)(j.Z,{color:"primary"})})})]})}}},function(e){e.O(0,[786,650,11,741,774,888,179],function(){return e(e.s=20251)}),_N_E=e.O()}]);